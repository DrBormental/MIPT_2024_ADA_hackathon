volume	section	page	text
1	Инструкция по установке PMS агента	1	"<br>Инструкция по установке PMS агента<br>==================================<br><br><br>Интеграция между TravelLine и вашей АСУ осуществляется при помощи программного компонента «TravelLine Pms Integration Agent» (далее «агент»), который представляет собой Windows компонент работающий на сервере гостиницы. Процесс настройки интеграции состоит из нескольких шагов, первым из которых является установка и настройка «агента». Ниже указаны требуемые действия, которые выполняются системным администратором гостиницы. После выполнения указанных действий вам необходимо сообщить своему менеджеру поддержки корректный IP адрес, по которому можно установить соединение с «агентом». Для установки и запуски «агента» требуется:<br><br><br>* получить от менеджера поддержки ZIP архив с «агентом»;<br>* установить «агента»;<br>* прописать параметры подключения к базе данных АСУ;<br>* запустить «агента»;<br>* проверить, что «агент» запустился и работает;<br>* выслать адрес доступа к агенту менеджеру поддержки.<br><br><br>В пунктах ниже будут приведены скриншоты с английской версии Windows 7. В случае установки «агента» под другую версию операционной системы скриншоты могут незначительно отличаться.<br><br><br> <br><br><br>Требования<br>----------<br><br><br>Для работы «агента» требуется:<br><br><br>* наличие на .NET 3.5 (SP1);<br>* открытый для внешних соединений TCP-порт на компьютере с установленным «агентом»;<br>* если доступ в интернет осуществляется через отдельный интернет-шлюз, то на шлюзе должен быть настроен проброс портов до компьютера с «агентом».<br>* при наличии защитного программного обеспечения (Windows firewall, антивирус и др.) на компьютере с «агентом», необходимо разрешить входящие/исходящие соединения на порт агента по протоколу https.<br><br><br>По умолчанию «агент» работает на порту 8055. В случае необходимости изменения порта обратитесь к своему менеджеру по сопровождению с соответствующим запросом. Изменение порта выполняется специалистами TravelLine.<br><br><br> <br><br><br>Установка агента<br>----------------<br><br><br>Все действия нужно производить под учетной записью Администратора:<br><br><br>* распакуйте архив;<br>* скопируйте версию «агента» нужной архитектуры (x86, x64) в новый каталог. Архитектура определяется тем, в какой из версий Data Sources (ODBC) настроен доступ для базу данных АСУ. Соответствующую информацию можно получить от представителей компании вашей АСУ, которые выполняли работы по установке АСУ.<br>* в консоли выполните две команды:после установки агента в списке служб должна появиться новая служба в статусе «Started»<br><br><br>	+ AgentService.exe install<br>	+ AgentService.exe start<br><br><br>![](https://138018.selcdn.ru/KB_images/omnideskru/10578/313561/7b93f8929eb81e3c69f4bdf63aef661e.png)<br> <br><br><br>Проверка запущен ли агент<br>-------------------------<br><br><br>1. На машине с агентом в браузере открыть url <https://127.0.0.1:8055/> должно появится предупреждение о https сертификате. Подобная страница означает, что «агент» запущен и позволяет подключаться с локального компьютера.<br><br>![](https://138018.selcdn.ru/KB_images/omnideskru/10578/313561/8fb50b164f74cfe163386c0b5ec899ae.png)<br> <br><br><br>2. В случае если страница не открывается, нужно проверить:<br><br>![](https://138018.selcdn.ru/KB_images/omnideskru/10578/313561/2a672521a20cb73472f7bb6d1aaad73c.png)<br> <br><br><br>Также нужно проверить, что агент открывается через внешний IP адрес. Для этого в браузере нужно открыть страницу с внешним ip https://<;внешний ip>:8055. После открытия страницы должно появится предупреждение о https сертификате, аналогичное указанному в пункте 1.<br><br><br>* Запущен ли windows компонент «TravelLine PMS Integration Agent»<br>* Разрешён ли порт в фаерволе<br><br><br>3. В случае если урл не открывается, нужно проверить, что ваше защитное программное обеспечение не блокирует доступ к «агенту». При выходе в сеть через интернет-шлюз нужно проверить корректность настройки проброса портов.<br><br><br>  <br><br><br>Удаление агента<br>---------------<br><br><br>В консоли выполните две команды:<br><br><br>* AgentService.exe stop<br>* AgentService.exe uninstall<br><br><br> <br>Установка нового агента поверх существующего<br>--------------------------------------------<br><br><br>Внимание! Перед выполнением действий прочитайте инструкцию до конца<br><br><br>* сохраните файл config.xml;<br>* в консоли выполните две команды: удалите содержимое каталога с агентом;<br><br><br>	+ AgentService.exe stop;<br>	+ AgentService.exe uninstall;<br>* распакуйте архив в каталог для агента;<br>* скопируйте в каталог агентом файл config.xml;<br>* в консоли выполните две команды:<br><br><br>	+ AgentService.exe install;<br>	+ AgentService.exe start.<br><br><br> <br><br><br>FAQ<br>---<br><br><br>**Ошибка:** служба агента не запускается или останавливается сразу после запуска **Решение:** <br><br><br>* проверьте, что компьютер, на котором агент соответствует «Требованиям», установите необходимые программные компоненты.<br>* проверьте, что пользователь, от имени которого запускается служба, имеет права на запуск служебных программ, а также имеет права на создание файлов в папке с установленным агентом. Установите необходимые права учетной записи.<br>* проверьте содержимое файла «[папка с установленным агентом]/Logs/startup.log», в случае возникновения системной ошибки там будет детальная информация. Перешлите ее вашему менеджеру поддержки.<br><br><br>****Ошибка:**** в браузере не открывается страница <https://127.0.0.1:8055> ****Решения:****<br><br><br>* проверьте наличие элемента <agentKey>[уникальный ключ агента]</agentKey> в файле config.xml. В случае отсутствия данного элемента обратитесь к менеджеру поддержки для получения ключа.<br>* пропишите в файле config.xml элемент <ignoreCertErrors>true</ignoreCertErrors> внутри элемента <config>.<br><br><br>**Ошибка:** в браузере открывается страница <https://127.0.0.1:8055>, но не открывается страница по внешнему адресу **Решения:**  <br><br><br><br>* проблема связана с настройками вашего защитного программного обеспечения - файрвола, антивируса. Нужно, что оно не блокировало входящий и исходящий траффик в «агенту» по протоколу https. Внесите соответствующие коррективы в настройки.<br>* в случае использование интернет шлюза проверьте настройки проброса портов с шлюза на сервер с установленным агентом.<br><br><br>**Ошибка:** менеджер поддержки сообщает вам, что архитектура установленного агента не соответствует настроенному источнику данных DSN **Решение:**  <br><br><br><br>* установите агента с другой архитектурой, 32 или 64 бита в зависимости от текущей установки.<br>"

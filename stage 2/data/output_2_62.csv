volume	section	page	text
1	Как каналу продаж продавать услуги через Partner API	1	<br>Как каналу продаж продавать услуги через Partner API<br>====================================================<br><br><br>1. Реализуйте доработку на тестовой среде <https://partner.qatl.ru/docs/booking-process/>.<br><br><br>2. Самостоятельно протестируйте доработку по всем пунктам чек-листа ниже. Для пунктов 1-8 чек-листа требуется создание скриншотов, демонстрирующих успешную реализацию и работоспособность. Для пунктов 9-11 скриншоты не требуются.<br><br><br>3. Запишите видеоролик, показывающий процесс бронирования с опцией дополнительных услуг. Бронирование должно соответствовать диаграмме:<br><br><br>![](https://138018.selcdn.ru/KB_images/omnideskru/10578/321155/d32b7cad4b7ec0e979b605e2f1415452.png)<br> <br><br><br>4. Отправьте подготовленные скриншоты и ссылку на сайт проекта, где доступно бронирование с возможностью предложения дополнительных услуг, на электронную почту [partner\_ota\_dynamic\_dev@travelline.ru](mailto:partner_ota_dynamic_dev@travelline.ru).<br><br><br>5. Мы проведем сертификацию в течение 5 рабочих дней. В случае нереализации или неполадок хотя бы в одном из пунктов чек-листа, потребуется дополнительная доработка.<br><br><br>6. После успешной сертификации, в течение 2 рабочих дней, мы активируем для вас функционал, позволяющий работать с дополнительными платными услугами на продуктовой среде.<br><br><br>7. Самостоятельно проинформировать отели о нововведении, предоставляющем возможность предлагать услуги за дополнительную плату.<br><br><br>  <br><br><br><br>****Чек-лист для тестирования продажи услуг на сайте OTA****<br><br><br>На тестовой среде у средства размещения id 7291 (PartnerAPI для сертификации услуг) настроены различные услуги для настройки и тестирования интеграции.<br><br><br>1. При поиске дополнительных услуг в рамках одного объекта размещения должна отображаться полная информация: наименование услуги, стоимость, доступное количество и изображения (при наличии).<br><br><br>2. Во время поиска должно обеспечиваться отсутствие дублирования услуг. На тестовой среде у тестового объекта размещения все варианты услуг уникальны.<br><br><br>3. Необходимо отображать информацию о доступных для приобретения услугах за дополнительную стоимость. Это должно происходить в соответствии с значением параметра calculationMethod в ответе метода API ​/v1​/properties​/{propertyId}​/services.<br><br><br>Чтобы проверить корректность выдачи услуг в API, отправьте запрос с поиском услуг на два взрослых, одного ребенка 5 лет и одного ребенка 10 лет.<br><br><br>Запрос:<br><br><br>![](https://138018.selcdn.ru/KB_images/omnideskru/10578/321155/196c6373a7a4a318f878ab2f366dd56c.png)<br> <br><br><br>**calculationMethod = PerPerson** — услуга предоставляется за гостя по одинаковой цене всем гостям.<br><br><br><br><br>| Response в API | Возможное отображение ответа API в канале |<br>| --- | --- |<br>|  |  |<br><br><br> <br><br><br>**calculationMethod = PerPersonByAge** — услуга предоставляется за гостя по разной стоимости, в зависимости от возраста гостей. Подробнее о настройке в личном кабинета средства размещения: «[Как настроить разные цены для взрослых и детей в дополнительных услугах](https://www.travelline.ru/support/knowledge-base/?id=314486)».  <br><br><br><br><br><br>| Response в API | Возможное отображение ответа API в канале |<br>| --- | --- |<br>|  | Услуга предоставляется взрослым и детям по разной стоимости: |<br>|  | Услуга доступна только для взрослых: |<br>|  | Услуга доступна только для детей от 0 до 6 лет: |<br>|  | Услуга доступна только для детей: |<br><br><br> <br><br><br>**calculationMethod = PerUse** — услуга предоставляется за одну штуку или за одно использование по одинаковой цене всем гостям.<br><br><br><br><br>| Response в API | Возможное отображение ответа API в канале |<br>| --- | --- |<br>|  |  |<br><br><br> <br><br><br>**calculationMethod = PerStay** — услуга предоставляется за номер по одной цене для всех гостей.<br><br><br><br><br>| Response в API | Возможное отображение ответа API в канале |<br>| --- | --- |<br>|  |  |<br><br><br> <br><br><br>4. Должна быть возможность поиска ограниченного количества услуг, не для всех гостей, включенных в бронь. Это касается услуг с начислением «За гостя» (PerPerson, PerPersonByAge) и «За использование» (PerUse). В запросе на поиск услуг (​/v1​/properties​/{propertyId}​/services) можно изменять состав и возраст гостей (placements, guestCount) для корректировки количества и стоимости услуг, доступных для бронирования.<br><br><br>5. При бронировании услуг с темпом PerUse в большем количестве, чем указано в параметре quantity, необходимо в методе verify указать желаемое количество услуг, но не превышающее maxQuantity. Далее нужно отобразить для гостя обновленную стоимость проживания и услуг перед подтверждением бронирования.<br><br><br>6. Перед шагом оплаты необходимо вызвать метод /bookings/verify. В ответе на этот запрос, значение checksum изменится из-за включения дополнительных платных услуг в бронь. После осуществления оплаты нужно вызвать метод создания бронирования, где проводится проверка корректности checksum.<br><br><br>7. Информация об обновленной стоимости бронирования должна быть представлена гостю на стороне канала продаж перед шагом оплаты, если в бронь были добавлены услуги за дополнительную плату.<br><br><br>8. Должна быть предусмотрена возможность отмены бронирования. При отмене активируется метод calculate-cancellation-penalty, который корректно отображает условия отмены на текущую дату, включая стоимость дополнительных услуг, входящих в предоплату.<br><br><br>9. Порядок фотографий дополнительных услуг должен строго соответствовать последовательности, указанной в API. Content и изображения этих услуг хранятся на стороне канала продаж.<br><br><br>10. В процессе поиска цен и осуществления бронирования методы Content API не используются, а изображения не загружаются с TravelLine.<br><br><br>11. Необходимо обеспечить корректную передачу данных в API, которые указываются при формировании запроса на создание бронирования.<br><br>

volume	section	page	text
1	Content API — описание объектов размещения	1	<br>Content API — описание объектов размещения<br>==========================================<br><br><br>Какие данные синхронизируются<br>-----------------------------<br><br><br>На схеме показаны этапы получения описания отеля в Content API — описание отеля, категорий номеров, тарифов, услуг, фото отеля и категорий номеров:<br><br><br>![ea7a83fff07d99474abdc5e54d23bd35.png](https://138018.selcdn.ru/KB_images/omnideskru/13074/282639/ea7a83fff07d99474abdc5e54d23bd35.png)<br> <br><br><br>Синхронизация работает только по объектам, которые настроят интеграцию с каналом продаж в менеджере каналов.<br><br><br>Мы не проверяем данные, которые отельеры добавляют в личном кабинете. Канал продаж при получении данных в Content API может проверить данные самостоятельно. Как правило, отели хорошо следят за контентом, так как эта информация отображается на официальном сайте при помощи [модуля бронирования TL: Booking Engine](https://www.travelline.ru/products/tl-hotel/).<br><br><br> <br><br><br>Как получить полное описание всех объектов размещения<br>-----------------------------------------------------<br><br><br>В методе /v1/properties Content API впишите в поле «include» — all.<br><br><br>![914f4eaa371a4e05e1d8943d133f3221.png](https://138018.selcdn.ru/KB_images/omnideskru/13074/282639/c8d89aff7798de8ecb0ba495747b5277.png)<br> <br><br><br>В каком порядке отображаются изображения в api/content и api/search<br>-------------------------------------------------------------------<br><br><br>Порядок устанавливается отельером в личном кабинете TravelLine и каналу продаж необходимо реализовать порядок отображения изображений объекта размещения или категории номера, который приходит по API.<br><br><br> <br><br><br>Как получить данные отелей определенного региона<br>------------------------------------------------<br><br><br>В Geo API V1 можно получить список объектов по стране, региону, городу. Например, для получения списка объектов по стране, выберите Geo API V1 → /v1/countries/{countryCode}/properties:<br><br><br>![6ae3fef4741910e9bd9b40c3ae7eba2a.png](https://138018.selcdn.ru/KB_images/omnideskru/13074/282639/2f0a8bf88ed7dce060181891cc7f7532.png)<br> <br><br><br>Пример ответа на запрос:<br><br><br>![7f3ca55354d49653fb70376c672eb472.png](https://138018.selcdn.ru/KB_images/omnideskru/13074/282639/989aeee6a9e183c8c181de983931b93a.png)<br> <br><br><br>Можно ли в TravelLine внести данные для конкретного канала<br>----------------------------------------------------------<br><br><br>Такие данные отель заполняет на стороне канала. Мы можем разместить только общую информацию и ссылку на ваш канал, при переходе по которой отель сможет заполнить все необходимые данные на вашей стороне. Пример того, что будет видеть отель:<br><br><br>![a2d2e15838c073d7ee7c506ac9c72821.png](https://138018.selcdn.ru/KB_images/omnideskru/13074/282639/89be1feaa46db81646993d83b24d90ce.png)<br> <br><br><br>Пример ссылки на форму регистрации: <https://secure.101hotels.com/join><br><br><br> <br><br><br>Информация о кроватях в номере<br>------------------------------<br><br><br>В теле ответа методов описания объектов размещений появились «Оснащения номеров» — roomTypes.amenities. Реализован справочник «Оснащения номеров» — /v1/room-amenity-categories.<br><br><br>  <br><br><br><br>Отправка событий каналам продаж через API<br>-----------------------------------------<br><br><br>Каналы продаж могут получать события, чтобы оперативно реагировать на изменение данных в TravelLine. Событийная модель реализована на основе webhooks — механизма оповещения пользователей системы о событиях. На схеме показаны этапы получения событий при изменении данных в Content API:<br><br><br>![fb56eb32a1b529631382deb4a1e37958.png](https://138018.selcdn.ru/KB_images/omnideskru/13074/282639/fb56eb32a1b529631382deb4a1e37958.png)<br>  <br><br><br><br>Виды событий: <br><br><br>* Добавление прав на средство размещения в рамках партнера (канала продаж).<br>* Удаление прав на средство размещения в рамках партнера (канала продаж).<br>* Изменение подключенного средства размещения к партнеру (каналу продаж). При обновлении прав партнера на средство размещения отправляются webhooks на изменение средства размещения. Отдельного события на изменение прав партнера на средство размещения не планируется.<br><br><br>Способ получения событий: <br><br><br>Канал продаж реализует на своей стороне публичный API endpoint, принимающий события, к которому система TravelLine может обращаться с авторизованным доступом.<br><br><br>При изменении контентной информации отельером на стороне TravelLine: описание и фото средства размещения, категорий номеров и тарифов — Платформа TravelLine направляет webhooks о том, что данные изменились, с помощью обращения к публичному endpoint.<br><br><br>Особенности:<br><br><br>* При получении ответа со статусом, отличным от 200, платформа TravelLine производит попытку повторного запроса. Задержка перед отправкой повторного запроса составляет 1 секунду.<br>* Таймаут при отправке событий — 45 секунд.<br>* События хранятся 3 дня.<br><br><br>Пример контракта данных на стороне партнера:<br><br><br>![](https://138018.selcdn.ru/KB_images/omnideskru/13074/282639/344f25bd2b679fb8652afd92edc9a1f9.png)<br> <br><br><br>Параметры:<br><br><br>* entityId — идентификатор сущности, по которой произошло изменение (средства размещения);<br>* eventType — тип события;<br>* eventCreationTime — время, когда событие произошло.<br><br><br>Периодичность отправки событий: события направляются пачками каждые 2 минуты, если за этот промежуток времени появились события для отправки. События в рамках одной пачки могут повторяться, в случае если произошло несколько изменений.<br><br><br><br><br>На первом этапе для подписки на события, необходимо направить следующие данные: <br><br><br>* Типы событий, которые ожидаете получать.<br>* API endpoint URL.<br>* API KEY для обеспечения авторизованного доступа.<br><br><br>**Обратите внимание**. При получении webhooks важно сохранить текущий принцип актуализации контента — обращение к методам Content API — 1 раз в сутки в ночное время, так как платформа TravelLine не гарантирует доставку всех сообщений до партнеров.<br><br><br><br>Как найти данные в конкретном регионе<br>-------------------------------------<br><br><br>1. Получаете список объектов в регионе: /api/geo/​v1​/regions​/{regionId}​/properties.<br><br><br>2. Передаете список объектов в метод поиска: /api/search/​v1​/properties​/room-stays​/search.<br><br><br> <br>Как найти данные в конкретном городе<br>------------------------------------<br><br><br>1. Получаете список объектов в городе: /api/geo/v1​/cities​/{cityId}​/properties.<br><br><br>2. Передаете список объектов в метод поиска: /api/search/v1/properties/room-stays/search.<br><br>

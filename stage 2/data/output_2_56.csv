volume	section	page	text
1	Reservation API — бронирование	1	<br>Reservation API — бронирование<br>==============================<br><br><br>Как происходит бронирование<br>---------------------------<br><br><br>Поиск по минимальной цене списка объектов → поиск по конкретному объекту → verify → booking.<br><br><br>![c4208ef397ca52b703c296fa2b904c65.png](https://138018.selcdn.ru/KB_images/omnideskru/13074/282644/c4208ef397ca52b703c296fa2b904c65.png)<br> <br><br><br>Требуемые поля:<br><br><br>* Checksum — берется из поиска по конкретному объекту в DetailedRoomStay. Это контрольная hash-сумма стоимости проживания, даты начала и суммы штрафа. Checksum не уникальна для каждого конкретного варианта проживания.<br>* CreateBookingToken — из api/reservation/v1/bookings/verify в VerifyBookingRs. При создании брони указывается уникальный токен createBookingToken, позволяющий создать только 1 бронь. Время жизни createBookingToken — 24 часа.<br><br><br> <br><br><br>Уведомления о бронировании или его отмене<br>-----------------------------------------<br><br><br>Канал продаж не получает уведомлений, так как сам создает бронирование через API и, соответственно, знает, что оно создано. Гость также не получает уведомлений, так как это логика канала. Уведомления отправляются только отельеру.<br><br><br> <br><br><br>Подтверждение бронирования<br>--------------------------<br><br><br>Partner API работает по системе «моментального подтверждения». Если бронь создалась — это гарантия доступности.<br><br><br>Изменение бронирования<br>----------------------<br><br><br>Данные в полях, которые не влияют на стоимость проживания, можно изменить. Например: <br><br><br>* Данные гостей (за исключением возраста детей) — booking.roomStays.guests, booking.roomStays.guestCount.<br>* Данные заказчика — booking.customer.<br>* Комментарии агента — booking.bookingComments.<br>* Информация по предоплате — booking.prepayment.<br><br><br>Количество изменений не ограничено. При изменении данных необходимо ориентироваться на структуру метода modify.<br><br><br>  <br><br><br><br>![84fac09c9fc9c08ac56c215d298d1957.png](https://138018.selcdn.ru/KB_images/omnideskru/13074/282644/84fac09c9fc9c08ac56c215d298d1957.png)<br>  <br><br><br><br>Оплата броней<br>-------------<br><br><br>TravelLine не участвует во взаиморасчетах между гостем, каналом и отелем. Бронирование номера отеля в канале полностью регулируется договорными отношениями между каналом продаж и отелем в рамках прямого договора.<br><br><br>Мы также не предоставляем эквайринг для каналов продаж. Эквайринг — это технология безналичного приема платежей с использованием банковских карт и систем бесконтактной оплаты.<br><br><br>Канал продаж может принимать как частичную, так и полную оплату, перечисляя потом эти деньги в отель. TravelLine передает условия отмены в канал в соответствии с тарифом. Если бронь при отмене будет попадать под штрафные правила, то эта информация также будет передана через API.<br><br><br>При активации канала отель выбирает сам, какие тарифы передать в канал. Это могут быть как возвратные, так и невозвратные тарифы. По общепринятым правилам, все бронирования становятся невозвратными, если бронь делается меньше, чем за 24 часа до заезда.<br><br><br> <br><br><br>Фактический размер оплаты брони гостем<br>--------------------------------------<br><br><br>При создании бронирования можно указать фактический размер оплаты, полученной от гостя в канале — booking.prepayment.prepaidSum.  <br>  <br>Информация будет отображаться в подтверждении брони:<br><br><br>![8656130e6eb2f2d2984289d0c5ce53a9.png](https://138018.selcdn.ru/KB_images/omnideskru/13074/282644/8656130e6eb2f2d2984289d0c5ce53a9.png)<br> <br><br><br>И на шахматке в TL: WebPMS:<br><br><br>![478f7f66165c98d6e412aef3a4a51f5d.png](https://138018.selcdn.ru/KB_images/omnideskru/13074/282644/478f7f66165c98d6e412aef3a4a51f5d.png)<br>  <br><br><br><br>Дополнительно можно также указать:<br><br><br>* Комментарий к оплате — booking.prepayment.remark;<br>* Тип оплаты — booking.prepayment.paymentType. «PrePay» — оплата произведена в канале, «Cash» — оплата осуществляется в отеле.<br><br><br> <br><br><br>Комментарий гостя и агента к бронированию<br>-----------------------------------------<br><br><br>При создании бронирования можно указать комментарий гостя к бронированию — booking.customer.comment. (максимум 250 символов) и комментарий агента к бронированию — booking.bookingComment. (максимальное количество комментариев — 5 по 250).<br><br><br>Информация будет отображаться в подтверждении брони:<br><br><br>![7f504a3c1f213492bb93f24fb36337f9.png](https://138018.selcdn.ru/KB_images/omnideskru/13074/282644/7f504a3c1f213492bb93f24fb36337f9.png)<br> <br><br><br>И на шахматке в TL: WebPMS:<br><br><br>![eab710a87d7535c053dce49a02cb5600.png](https://138018.selcdn.ru/KB_images/omnideskru/13074/282644/eab710a87d7535c053dce49a02cb5600.png)<br> <br><br><br>Минимальное и максимальное значение параметра childAges<br>-------------------------------------------------------<br><br><br>0-18 лет.<br><br><br> <br><br><br>Информации о гостях<br>-------------------<br><br><br>Важно заполнить информацию по всем гостям, так как эти данные сразу отправляются в АСУ отеля:<br><br><br>![a14ba5779b34527f9fceb5c2a75c6e3e.png](https://138018.selcdn.ru/KB_images/omnideskru/13074/282644/d763fa5a19af8dca75a603157fb39e4e.png)<br>  <br><br><br><br>Модификация бронирования до заезда<br>----------------------------------<br><br><br>Отель не может редактировать канальное бронирование. Модификацию с изменением стоимости бронирования необходимо производить через отмену. <br><br><br>Модификация после наступления даты заезда<br>-----------------------------------------<br><br><br>В случае незаезда или изменений условий проживания, средство размещения самостоятельно сообщает каналу эту информацию, например, по email. Далее канал на этапе сверки «Канал — TL» меняет сумму по бронированию в зависимости от размера оплаты и штрафа.  <br> <br><br><br>Отмена брони<br>------------<br><br><br>Отель не может отменить канальное бронирование в личном кабинете TravelLine. Отмена происходит на стороне канала через API.<br><br><br> <br><br><br>Штраф при отмене брони<br>----------------------<br><br><br>Есть метод API — api/reservation/v1/bookings/{number}/calculate-cancellation-penalty, который позволяет рассчитать сумму штрафу за отмену бронирования.  <br><br><br><br>![baaebe53c0b63c87860e388cc8ffe5ef.png](https://138018.selcdn.ru/KB_images/omnideskru/13074/282644/8833c605823ca86c3afcfcbf238b8dc8.png)<br> <br><br><br>Расторжение договора на бронирование со стороны отельера<br>--------------------------------------------------------<br><br><br>Как правило, если отельер расторгает договор, то в этом случае он все равно должен заселить гостей по броням на будущие даты и провести сверку. Обычно это фиксируется в договоре.<br><br><br> <br><br><br>Статистика времени ответа на запросы<br>------------------------------------<br><br><br>Создание брони:<br><br><br>* 90 pt — 3695 ms;<br>* 95 pt — 4332 ms.<br><br><br>Получение брони:<br><br><br>* 90 pt — 638 ms;<br>* 95 pt — 721 ms.<br><br><br>Расчет суммы штрафа за отмену:<br><br><br>* 90 pt — 652 ms;<br>* 95 pt — 798 ms.<br><br><br>Проверка возможности создать бронирование:<br><br><br>* 90 pt — 725 ms;<br>* 95 pt — 854 ms.<br>
